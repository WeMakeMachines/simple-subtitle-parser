var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])},r(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}"function"==typeof SuppressedError&&SuppressedError;var n=function(r){var t=r.hours,n=void 0===t?0:t,e=r.minutes,o=void 0===e?0:e,i=r.seconds,s=void 0===i?0:i,u=r.milliseconds,a=1e3;return 60*n*60*a+60*o*a+s*a+(void 0===u?0:u)},e=function(r){function n(){return null!==r&&r.apply(this,arguments)||this}return t(n,r),n}(Error),o=function(){function r(){}return r.parseTimeStamps=function(t,e){var o=t.split(e),i=o[0],s=o[1];if(s){var u=r.splitTimeStamp(i),a=r.splitTimeStamp(s);return{startTime:n(u),endTime:n(a)}}},r.splitTimeStamp=function(r){var t=r.split(":"),n=t[0],o=t[1],i=t[2],s=i.includes(",")?",":i.includes(".")?".":"";if(""===s)throw new e("Unable to process timestamp");var u=i.split(s),a=u[0],c=u[1];return{hours:Number(n),minutes:Number(o),seconds:Number(a),milliseconds:Number(c)}},r}(),i=function(r){function n(){return null!==r&&r.apply(this,arguments)||this}return t(n,r),n}(Error),s=function(){function r(){}return r.processStringToArray=function(r){return r.split("\n")},r.processArrayToArrayBlocks=function(r){return r.reduce((function(r,t){return""===t?r.push([]):r[r.length-1].push(t),r}),[[]])},r.dropEmptyArrayBlocks=function(r){return r.filter((function(r){return r.length}))},r.processArrayBlocksToCues=function(r,t){return r.map((function(r,n){var e=r.reduce((function(r,n,e){if(0===e&&!n.includes(t))return r;if(!r.endTime&&n.includes(t)){var i=o.parseTimeStamps(n,t);return i&&(r.startTime=i.startTime,r.endTime=i.endTime),r}return r.text.push(n),r}),{sequence:n,startTime:0,endTime:0,text:[]});if(e.endTime<=e.startTime)throw new i("Invalid Cue: Timecodes not valid");return e}))},r}(),u=function(r){function n(){var t=null!==r&&r.apply(this,arguments)||this;return t.timeStampMarker="--\x3e",t}return t(n,r),n.prototype.parse=function(r){var t=s.processStringToArray(r),n=s.processArrayToArrayBlocks(t),e=s.dropEmptyArrayBlocks(n);return s.processArrayBlocksToCues(e,this.timeStampMarker)},n}(s),a=function(r){function n(){var t=null!==r&&r.apply(this,arguments)||this;return t.timeStampMarker="--\x3e",t}return t(n,r),n.prototype.parse=function(r){var t=s.processStringToArray(r),n=s.processArrayToArrayBlocks(t),e=s.dropEmptyArrayBlocks(n),o=this.dropNonCueData(e);return s.processArrayBlocksToCues(o,this.timeStampMarker)},n.prototype.dropNonCueData=function(r){return r.filter((function(r){var t=r[0];return!(t.startsWith("WEBVTT")||t.startsWith("NOTE")||t.startsWith("STYLE"))}))},n}(s),c=function(r,t){return new Promise((function(n,e){var o="WEBVTT"===r?new a:new u;try{n(o.parse(t))}catch(r){e(r)}}))};export{c as default};
